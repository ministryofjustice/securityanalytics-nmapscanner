function:
  handler: results_parser.results_parser.parse_results
  name: ${self:custom.deployStage}-${self:service}-results-parser
  role: ${ssm:/${self:custom.appName}/${self:custom.deployStage}/tasks/${self:custom.pluginName}/results/role/arn}
  environment:
    REGION: ${self:provider.region}
    STAGE: ${self:custom.deployStage}
    APP_NAME: ${self:custom.appName}
    TASK_NAME: ${self:custom.pluginName}
  layers:
    - ${ssm:/${self:custom.appName}/${self:custom.ssmSourceStage}/lambda/layer/utils}
  events:
    - existingS3:
        bucket: ${ssm:/${self:custom.appName}/${self:custom.deployStage}/tasks/${self:custom.pluginName}/s3/results/id}
        events:
          - s3:ObjectCreated:*
        rules:
          - prefix: /
          - suffix: .tar.gz
